<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Sweeps (invite only) · W&amp;B</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Sweeps (invite only) · W&amp;B"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.wandb.com/index.html"/><meta property="og:description" content="## Overview"/><meta property="og:image" content="https://docs.wandb.com/img/wandb.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://docs.wandb.com/img/wandb.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/wandb-long.svg" alt="W&amp;B"/><h2 class="headerTitle">W&amp;B</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/started.html" target="_self">Docs</a></li><li class=""><a href="https://wandb.com" target="_self">Company</a></li><li class=""><a href="https://app.wandb.ai" target="_self">Login</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Sweeps</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Getting Started</h3><ul><li class="navListItem"><a class="navItem" href="/docs/started.html">Getting Started</a></li></ul></div><div class="navGroup navGroupActive"><h3>Python Library</h3><ul><li class="navListItem"><a class="navItem" href="/docs/configs.html">Saving Hyperparameters</a></li><li class="navListItem"><a class="navItem" href="/docs/logs.html">Logging Metrics</a></li><li class="navListItem"><a class="navItem" href="/docs/images.html">Images</a></li><li class="navListItem"><a class="navItem" href="/docs/histograms.html">Histograms</a></li><li class="navListItem"><a class="navItem" href="/docs/saving.html">Saving Files</a></li><li class="navListItem"><a class="navItem" href="/docs/keras.html">Keras Support</a></li><li class="navListItem"><a class="navItem" href="/docs/pytorch.html">PyTorch Support</a></li><li class="navListItem"><a class="navItem" href="/docs/jupyter.html">Jupyter</a></li><li class="navListItem"><a class="navItem" href="/docs/api.html">Data API</a></li></ul></div><div class="navGroup navGroupActive"><h3>Command Line</h3><ul><li class="navListItem"><a class="navItem" href="/docs/cli.html">Command Line Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/restoring.html">Restoring State</a></li></ul></div><div class="navGroup navGroupActive"><h3>Advanced Usage</h3><ul><li class="navListItem"><a class="navItem" href="/docs/automated.html">Environment Variables</a></li><li class="navListItem"><a class="navItem" href="/docs/grouping.html">Grouping</a></li><li class="navListItem"><a class="navItem" href="/docs/resuming.html">Resuming</a></li><li class="navListItem"><a class="navItem" href="/docs/security.html">Security</a></li><li class="navListItem"><a class="navItem" href="/docs/limits.html">Limits</a></li></ul></div><div class="navGroup navGroupActive"><h3>Sweeps</h3><ul><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/sweep.html">Hyperparameter Sweeps</a></li></ul></div><div class="navGroup navGroupActive"><h3>Examples</h3><ul><li class="navListItem"><a class="navItem" href="/docs/keras-example.html">Keras</a></li><li class="navListItem"><a class="navItem" href="/docs/tensorflow-example.html">TensorFlow</a></li><li class="navListItem"><a class="navItem" href="/docs/pytorch-example.html">PyTorch</a></li><li class="navListItem"><a class="navItem" href="/docs/examples.html">More Projects</a></li></ul></div><div class="navGroup navGroupActive"><h3>Resources</h3><ul><li class="navListItem"><a class="navItem" href="/docs/faq.html">FAQ</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Sweeps (invite only)</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="overview"></a><a href="#overview" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h2>
<p>W&amp;B supports running hyperparameter sweeps to find the best set of hyperparameters efficiently.  If you would like to try our solution, email <a href="mailto:contact@wandb.com">contact@wandb.com</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="getting-started"></a><a href="#getting-started" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Getting Started</h3>
<p>To run a parameter sweep:</p>
<ol>
<li>Initialize your project to use wandb in the cloud.</li>
<li>Create a sweep.yaml file specified below, which specified your training script, your parameter
ranges and the search strategy.</li>
<li>Initialize your sweep, which gives you a SWEEP_ID and a url to track all of
your runs.</li>
<li>Run wandb agent, which will get a set of parameter names and arguments from the
wandb server and then run your training script with the parameters as arguments.  You can
run as many agents as you like.</li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="start-a-search-from-your-projects-root-directory"></a><a href="#start-a-search-from-your-projects-root-directory" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Start a search from your projects root directory</h3>
<pre><code class="hljs css shell">wandb init # If you haven't already initialized your project
wandb sweep sweep.yaml # returns SWEEP_ID.
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="start-an-agent"></a><a href="#start-an-agent" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Start an agent</h3>
<pre><code class="hljs css shell">wandb agent SWEEP_ID
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="sweepyaml-file"></a><a href="#sweepyaml-file" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sweep.yaml File</h2>
<blockquote>
<p>Example sweep.yaml</p>
</blockquote>
<pre><code class="hljs css yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">random</span> <span class="hljs-string">sweep</span> <span class="hljs-string">for</span> <span class="hljs-string">my</span> <span class="hljs-string">little</span> <span class="hljs-string">cnn</span>

<span class="hljs-comment"># Training script to run</span>
<span class="hljs-attr">program:</span> <span class="hljs-string">cnn.py</span>  

<span class="hljs-comment"># Method can be bayes, random, grid</span>
<span class="hljs-attr">method:</span> <span class="hljs-string">bayes</span>

<span class="hljs-comment"># Metric to optimize</span>
<span class="hljs-attr">metric:</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">val_loss</span>
<span class="hljs-attr">  goal:</span> <span class="hljs-string">minimize</span>

<span class="hljs-comment"># Should we early terminate runs</span>
<span class="hljs-attr">early_terminate:</span>
<span class="hljs-attr">  type:</span> <span class="hljs-string">envelope</span>

<span class="hljs-comment"># Parameters to search over</span>
<span class="hljs-attr">parameters:</span>
<span class="hljs-attr">  learning-rate:</span>
<span class="hljs-attr">    min:</span> <span class="hljs-number">0.001</span>
<span class="hljs-attr">    max:</span> <span class="hljs-number">0.1</span>
<span class="hljs-attr">  optimizer:</span>
<span class="hljs-attr">    values:</span> <span class="hljs-string">["adam",</span> <span class="hljs-string">"sgd"</span><span class="hljs-string">]</span>
<span class="hljs-attr">  dropout:</span>
<span class="hljs-attr">    min:</span> <span class="hljs-number">0.01</span>
<span class="hljs-attr">    max:</span> <span class="hljs-number">0.5</span>
<span class="hljs-attr">  epochs:</span>
<span class="hljs-attr">    value:</span> <span class="hljs-number">30</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="method"></a><a href="#method" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Method</h3>
<table>
<thead>
<tr><th>Values</th><th>Meaning</th></tr>
</thead>
<tbody>
<tr><td>grid</td><td>Grid Search - Will iterate over all possible sets of values in parameters.</td></tr>
<tr><td>random</td><td>Random Search - Will choose random sets of values</td></tr>
<tr><td>bayes</td><td>Bayesian Optimization - Uses a gaussian process to model the function and then chooses parameters to optimize probability of improvement</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="early-terminate"></a><a href="#early-terminate" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Early Terminate</h3>
<p>Early termination is a strategy to speed up hyperparameter search by killing off runs that
appear to have lower performance than successful training runs.</p>
<table>
<thead>
<tr><th>Values</th><th>Meaning</th></tr>
</thead>
<tbody>
<tr><td>envelope</td><td>Use an envelope method for early termination/</td></tr>
<tr><td>Not Specified</td><td>Don't do early termination.</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="parameters"></a><a href="#parameters" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Parameters</h3>
<p>The parameters dictionary specifies the ranges of configuration parameters.</p>
<table>
<thead>
<tr><th>Values</th><th>Meaning</th></tr>
</thead>
<tbody>
<tr><td>distribution:</td><td>A distribution from the distrbution table below.  If not specified, the sweep will set to uniform is max and min are set, categorical if values are set and constant if value is set.</td></tr>
<tr><td>min: (float) max: (float)</td><td>Continuous values between min and max</td></tr>
<tr><td>min: (int) max: (int)</td><td>Integers between min and max</td></tr>
<tr><td>values: [a, b, c]</td><td>Discrete values</td></tr>
<tr><td>value:</td><td>A constant</td></tr>
<tr><td>mu:</td><td>Mean for normal or lognormal distributions</td></tr>
<tr><td>sigma:</td><td>Std Dev for normal or lognormal distributions</td></tr>
<tr><td>q:</td><td>Quantization parameter for quantized distributions</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="distributions"></a><a href="#distributions" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Distributions</h3>
<p>Supported distributions</p>
<table>
<thead>
<tr><th>Name</th><th>Meaning</th></tr>
</thead>
<tbody>
<tr><td>constant</td><td>Constant distribution.  Must specify value.</td></tr>
<tr><td>categorical</td><td>Categorical distribution.  Must specify values.</td></tr>
<tr><td>int_uniform</td><td>Uniform integer.  Must specify max and min as integers.</td></tr>
<tr><td>uniform</td><td>Uniform continuous.  Must specify max and min as floats.</td></tr>
<tr><td>q_uniform</td><td>Quantized uniform.  Returns  round(X / q) * q where X is uniform.  Q defaults to 1.</td></tr>
<tr><td>log_uniform</td><td>Log uniform.  Number between exp(min) and exp(max) so that the logarithm of the return value is uniformly distributed.</td></tr>
<tr><td>q_log_uniform</td><td>Quantized log uniform.  Returns  round(X / q) * q where X is log_uniform.  Q defaults to 1.</td></tr>
<tr><td>normal</td><td>Normal distribution.  Value is chosen from normal distribution.  Can set mean mu (default 0) and std dev sigma (default 1).</td></tr>
<tr><td>q_normal</td><td>Quantized normal distribution.  Returns  round(X / q) * q where X is normal.  Q defaults to 1.</td></tr>
<tr><td>log_normal</td><td>Log normal distribution. Value is chosen from log normal distribution.  Can set mean mu (default 0) and std dev sigma (default 1).</td></tr>
<tr><td>q_log_normal</td><td>Quantized log normal distribution.  Returns  round(X / q) * q where X is log_normal.  Q defaults to 1.</td></tr>
</tbody>
</table>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="limits.html">← Limits</a><a class="docs-next button" href="keras-example.html">Keras Example →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#overview">Overview</a><ul class="toc-headings"><li><a href="#getting-started">Getting Started</a></li><li><a href="#start-a-search-from-your-projects-root-directory">Start a search from your projects root directory</a></li><li><a href="#start-an-agent">Start an agent</a></li></ul></li><li><a href="#sweepyaml-file">Sweep.yaml File</a><ul class="toc-headings"><li><a href="#method">Method</a></li><li><a href="#early-terminate">Early Terminate</a></li><li><a href="#parameters">Parameters</a></li><li><a href="#distributions">Distributions</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/wandb.svg" alt="W&amp;B" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/started.html">Getting Started</a><a href="/docs/configs.html">Python API Reference</a><a href="/docs/examples.html">Example Projects</a></div><div><h5>More</h5><a href="https://github.com/wandb/client">GitHub</a><a href="https://wandb.com">W&amp;B</a></div></section><section class="copyright">Copyright © 2018 Weights &amp; Biases, Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: '0510e717ad08795f12b729ed540687cb',
                indexName: 'wandb',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>